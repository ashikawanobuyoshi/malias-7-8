{"version":3,"file":"login-B43bLAo4.js","sources":["../../../../pages/login.vue"],"sourcesContent":["<template>\r\n    <client-only>\r\n  <form @submit.prevent=\"handleLogin\">\r\n    <input\r\n      type=\"email\"\r\n      v-model=\"email\"\r\n      name=\"email\"\r\n      id=\"email\"\r\n      autocomplete=\"email\"\r\n      placeholder=\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\"\r\n      required\r\n    />\r\n    <input\r\n      type=\"password\"\r\n      v-model=\"password\"\r\n      name=\"password\"\r\n      id=\"password\"\r\n      autocomplete=\"current-password\"\r\n      placeholder=\"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰\"\r\n      required\r\n    />\r\n    <button type=\"submit\">ãƒ­ã‚°ã‚¤ãƒ³</button>\r\n    <p v-if=\"errorMessage\">{{ errorMessage }}</p>\r\n  </form>\r\n  </client-only>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, nextTick } from 'vue' // nextTick ã‚’è¿½åŠ \r\nimport { useRouter } from 'vue-router'\r\nimport { useCookie } from '#app'\r\n\r\nconst email = ref('')\r\nconst password = ref('')\r\nconst errorMessage = ref('')\r\n\r\nconst router = useRouter()\r\n\r\nconst handleLogin = async () => {\r\n  console.log('handleLoginå®Ÿè¡Œ')\r\n  try {\r\n    const res = await $fetch('/api/login', {\r\n      method: 'POST',\r\n      body: { email: email.value, password: password.value }\r\n    })\r\n\r\n    console.log('âœ… ãƒ¬ã‚¹ãƒãƒ³ã‚¹:', res)\r\n\r\n    if (res.success) {\r\n      console.log('âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¿å­˜:', res.user)\r\n\r\n      localStorage.setItem('user', JSON.stringify(res.user))\r\n      localStorage.setItem('isAuthenticated', 'true')\r\n\r\n      const isAuthenticated = useCookie('isAuthenticated')\r\n      isAuthenticated.value = 'true'\r\n\r\n      await nextTick()  \r\n      await new Promise((resolve) => setTimeout(resolve, 100))\r\n\r\n      console.log('ğŸ” ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¸é·ç§»å®Ÿè¡Œ')\r\n      await router.push('/')\r\n\r\n      console.log('âœ… é·ç§»æˆåŠŸ')\r\n    } else {\r\n      errorMessage.value = 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™ã€‚'\r\n    }\r\n  } catch (err) {\r\n    console.error('ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—:', err)\r\n    errorMessage.value = 'é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚'\r\n  }\r\n}\r\n</script>\r\n\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAgCc,QAAI,EAAE;AACH,QAAI,EAAE;AACF,QAAI,EAAE;AAEZ,cAAA;;;;;;;;;;;;;"}