import{_ as g}from"./DqPHLXxX.js";import{g as v,r as i,B as w,w as _,j as f,o as u,a,C as h,q as c,c as y,s as k,v as m,t as x,m as S,D as B}from"./C_xtq39S.js";const C={key:0},q=v({__name:"login",setup(b){const s=i(""),l=i(""),t=i(""),p=f(),d=async()=>{console.log("handleLogin実行");try{const o=await $fetch("/api/login",{method:"POST",body:{email:s.value,password:l.value}});if(console.log("✅ レスポンス:",o),o.success){console.log("✅ ユーザー保存:",o.user),localStorage.setItem("user",JSON.stringify(o.user)),localStorage.setItem("isAuthenticated","true");const e=S("isAuthenticated");e.value="true",await B(),await new Promise(n=>setTimeout(n,100)),console.log("🔁 トップページへ遷移実行"),await p.push("/"),console.log("✅ 遷移成功")}else t.value="メールアドレスまたはパスワードが間違っています。"}catch(o){console.error("ログイン失敗:",o),t.value="通信エラーが発生しました。"}};return(o,e)=>{const n=g;return u(),w(n,null,{default:_(()=>[a("form",{onSubmit:h(d,["prevent"])},[c(a("input",{type:"email","onUpdate:modelValue":e[0]||(e[0]=r=>s.value=r),name:"email",id:"email",autocomplete:"email",placeholder:"メールアドレス",required:""},null,512),[[m,s.value]]),c(a("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=r=>l.value=r),name:"password",id:"password",autocomplete:"current-password",placeholder:"パスワード",required:""},null,512),[[m,l.value]]),e[2]||(e[2]=a("button",{type:"submit"},"ログイン",-1)),t.value?(u(),y("p",C,x(t.value),1)):k("",!0)],32)]),_:1})}}});export{q as default};
